(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");if(i.length)for(var o=i.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=i[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"images/2dbd01ce16c0fa83cb67.png";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}function o(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var r=function(){return e=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rows=n,this.cols=i,this.onClick=null,this.element=this.createGnomeElement(t)},t=[{key:"createGnomeElement",value:function(e){var t=this,n=document.createElement("img");return n.src=e,n.className="gnome",n.alt="Gnome",n.addEventListener("click",(function(e){e.stopPropagation(),t.onClick&&t.onClick()})),n}}],t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}function c(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var l=function(){return e=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rows=t,this.cols=n,this.gnomeImage=i,this.board=null,this.gnome=null,this.intervalId=null,this.moveInterval=1e3,this.score=0,this.misses=0,this.maxMisses=5,this.currentPosition=null,this.gnomeClicked=!1,this.isGameActive=!1},(t=[{key:"updateUI",value:function(){document.getElementById("score").textContent=this.score,document.getElementById("misses").textContent=this.misses}},{key:"init",value:function(){var e=this;this.createBoard(),this.gnome=new r(this.gnomeImage,this.rows,this.cols),this.gnome.onClick=function(){e.isGameActive&&(e.score++,e.gnomeClicked=!0,e.updateUI())},this.startGame()}},{key:"createBoard",value:function(){this.board=document.getElementById("gameBoard"),this.board.innerHTML="";for(var e=0;e<this.rows*this.cols;e+=1){var t=document.createElement("div");t.className="cell",t.dataset.index=e,this.board.appendChild(t)}}},{key:"startGame",value:function(){this.resetGame(),this.isGameActive=!0,this.placeGnomeRandomly(),this.startMoving()}},{key:"resetGame",value:function(){this.score=0,this.misses=0,this.gnomeClicked=!1,this.updateUI(),this.gnome&&this.gnome.element.parentNode&&this.gnome.element.parentNode.removeChild(this.gnome.element)}},{key:"placeGnomeRandomly",value:function(){var e=document.querySelectorAll(".cell"),t=Math.floor(Math.random()*e.length);this.currentPosition=t,e[t].appendChild(this.gnome.element)}},{key:"moveGnome",value:function(){var e=this;if(this.isGameActive){if(!this.gnomeClicked&&null!==this.currentPosition&&(this.misses++,this.updateUI(),this.misses>=this.maxMisses))return this.endGame(),void setTimeout((function(){return e.startGame()}),2e3);this.gnomeClicked=!1;var t,n=document.querySelectorAll(".cell");do{t=Math.floor(Math.random()*n.length)}while(t===this.currentPosition);n[t].appendChild(this.gnome.element),this.currentPosition=t}}},{key:"startMoving",value:function(){var e=this;this.stopMoving(),this.intervalId=setInterval((function(){e.moveGnome()}),this.moveInterval)}},{key:"endGame",value:function(){this.isGameActive=!1,this.stopMoving(),this.showGameOverMessage()}},{key:"stopMoving",value:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}},{key:"showGameOverMessage",value:function(){var e=document.createElement("div");e.className="game-over-message",e.textContent="Игра окончена! Начинаем заново...",document.body.appendChild(e),setTimeout((function(){document.body.removeChild(e)}),2e3)}}])&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();document.addEventListener("DOMContentLoaded",(function(){new l(4,4,t).init()}))})();